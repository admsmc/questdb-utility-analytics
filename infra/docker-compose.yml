services:
  questdb:
    image: questdb/questdb:latest
    container_name: questdb
    restart: unless-stopped
    ports:
      - "9000:9000"  # Web console
      - "8812:8812"  # Postgres wire protocol
      - "9009:9009"  # InfluxDB line protocol
    environment:
      - QDB_CAIRO_MAX_FD=100000
    volumes:
      # Store DB data inside the Docker VM filesystem (more compatible/faster than bind mounts on Docker Desktop).
      - questdb-data:/var/lib/questdb
      # Keep conf/import as bind mounts for easy iteration.
      - ./questdb-conf:/var/lib/questdb/conf
      - ./questdb-import:/var/lib/questdb/import
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 20s

volumes:
  questdb-data:
